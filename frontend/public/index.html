<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My PG Rentals</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .header {
      background-color: #3f51b5;
      color: white;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .pg-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    .pg-card {
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }
    .pg-card:hover {
      transform: translateY(-5px);
    }
    .pg-image {
      height: 200px;
      background-size: cover;
      background-position: center;
    }
    .pg-content {
      padding: 20px;
    }
    .amenities {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-top: 10px;
    }
    .amenity {
      background-color: #e3f2fd;
      color: #1976d2;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
    }
    .rooms {
      margin-top: 10px;
    }
    .room {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #eee;
      padding: 5px 0;
    }
    .room-status {
      font-weight: bold;
      color: #4caf50;
    }
    .room-status.unavailable {
      color: #f44336;
    }
    .btn {
      display: inline-block;
      background-color: #3f51b5;
      color: white;
      padding: 10px 15px;
      border-radius: 4px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-top: 15px;
    }
    .btn:hover {
      background-color: #303f9f;
    }
    .loading {
      text-align: center;
      padding: 40px;
      font-size: 18px;
      color: #666;
    }
    .error {
      background-color: #ffebee;
      color: #c62828;
      padding: 15px;
      border-radius: 4px;
      margin: 20px 0;
    }
    .pg-detail {
      display: none;
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }
    .pg-detail.active {
      display: block;
    }
    .back-btn {
      background-color: #f5f5f5;
      color: #333;
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>My PG Rentals</h1>
    <a href="#" id="admin-link" class="btn">Admin Login</a>
  </div>

  <main>
    <div id="home-page">
      <h2>Find Your Perfect PG Accommodation</h2>
      <p>Browse through our curated list of PG accommodations in premium locations</p>
      
      <div id="pgs-container">
        <div class="loading">Loading PG listings...</div>
      </div>
    </div>

    <div id="detail-page" class="pg-detail">
      <!-- PG details will be loaded here -->
    </div>

    <div id="admin-page" class="pg-detail">
      <h2>Admin Panel</h2>
      <p>Manage your PG listings</p>
      
      <div id="login-form">
        <h3>Login</h3>
        <input type="password" id="admin-password" placeholder="Enter admin password" style="padding: 10px; width: 100%; margin-bottom: 10px;">
        <button id="login-btn" class="btn">Login</button>
        <p id="login-error" style="color: #f44336; display: none;">Incorrect password</p>
      </div>
      
      <div id="admin-content" style="display: none;">
        <h3>Your PG Listings</h3>
        <button id="add-pg-btn" class="btn">Add New PG</button>
        <div id="admin-pgs-list"></div>
        
        <div id="pg-form" style="display: none; margin-top: 20px; background: #f9f9f9; padding: 20px; border-radius: 8px;">
          <h3 id="form-title">Add New PG</h3>
          <form id="pg-edit-form">
            <input type="hidden" id="pg-id">
            <div style="margin-bottom: 15px;">
              <label for="pg-title">Title</label>
              <input type="text" id="pg-title" required style="width: 100%; padding: 8px;">
            </div>
            <div style="margin-bottom: 15px;">
              <label for="pg-location">Location</label>
              <input type="text" id="pg-location" required style="width: 100%; padding: 8px;">
            </div>
            <div style="margin-bottom: 15px;">
              <label for="pg-location-link">Location Link (Google Maps)</label>
              <input type="text" id="pg-location-link" style="width: 100%; padding: 8px;">
            </div>
            <div style="margin-bottom: 15px;">
              <label for="pg-description">Description</label>
              <textarea id="pg-description" rows="4" style="width: 100%; padding: 8px;"></textarea>
            </div>
            <div style="margin-bottom: 15px;">
              <label>Amenities (comma-separated)</label>
              <input type="text" id="pg-amenities" placeholder="e.g. WiFi, AC, Parking" style="width: 100%; padding: 8px;">
            </div>
            <div style="margin-bottom: 15px;">
              <label>Image URL</label>
              <input type="text" id="pg-image" placeholder="Enter image URL" style="width: 100%; padding: 8px;">
            </div>
            
            <h4>Rooms</h4>
            <div id="rooms-container">
              <div class="room-input" style="border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; border-radius: 4px;">
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                  <div style="flex: 1;">
                    <label>Type</label>
                    <select class="room-type" style="width: 100%; padding: 8px;">
                      <option value="Attached">Attached</option>
                      <option value="Shared">Shared</option>
                    </select>
                  </div>
                  <div style="flex: 1;">
                    <label>Price</label>
                    <input type="number" class="room-price" min="0" style="width: 100%; padding: 8px;">
                  </div>
                  <div style="flex: 1;">
                    <label>Available</label>
                    <select class="room-available" style="width: 100%; padding: 8px;">
                      <option value="true">Yes</option>
                      <option value="false">No</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <button type="button" id="add-room-btn" class="btn" style="background-color: #4caf50; margin-right: 10px;">Add Room</button>
            
            <div style="margin-top: 20px;">
              <button type="button" id="cancel-form-btn" class="btn back-btn">Cancel</button>
              <button type="submit" class="btn">Save PG</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // DOM elements
      const pgsContainer = document.getElementById('pgs-container');
      const homePage = document.getElementById('home-page');
      const detailPage = document.getElementById('detail-page');
      const adminPage = document.getElementById('admin-page');
      const adminLink = document.getElementById('admin-link');
      const loginForm = document.getElementById('login-form');
      const adminContent = document.getElementById('admin-content');
      const loginBtn = document.getElementById('login-btn');
      const adminPassword = document.getElementById('admin-password');
      const loginError = document.getElementById('login-error');
      const addPgBtn = document.getElementById('add-pg-btn');
      const pgForm = document.getElementById('pg-form');
      const formTitle = document.getElementById('form-title');
      const pgEditForm = document.getElementById('pg-edit-form');
      const cancelFormBtn = document.getElementById('cancel-form-btn');
      const addRoomBtn = document.getElementById('add-room-btn');
      const roomsContainer = document.getElementById('rooms-container');
      
      // Application state
      let pgs = [];
      let currentPgId = null;
      const adminPwd = "admin123"; // In a real app, this would be securely stored and verified server-side
      
      // Sample PG data (for demonstration)
      const samplePGs = [
        {
          id: '1',
          title: 'Spacious 3-Storey PG in City Center',
          location: 'Koramangala, Bangalore',
          locationLink: 'https://maps.app.goo.gl/KMjGd1uU2hN1kkU39',
          description: 'Newly constructed PG, only 3 months old, located in the main city area with all basic necessities nearby. Just 200m from hospitals and schools. Ideal for bachelors with 2-wheelers (no car parking).',
          rooms: [
            { type: 'Attached', price: 9000, available: true },
            { type: 'Attached', price: 7500, available: true },
            { type: 'Attached', price: 7500, available: false },
            { type: 'Attached', price: 7500, available: true },
            { type: 'Shared', price: 5500, available: true }
          ],
          amenities: ['2-Wheeler Parking', 'Nearby Schools', 'Nearby Hospitals', 'Main City Area', 'Neat & Clean'],
          image: 'https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af'
        },
        {
          id: '2',
          title: 'Green View PG for Professionals',
          location: 'HSR Layout, Bangalore',
          locationLink: 'https://maps.app.goo.gl/abcd1234',
          description: 'Modern PG accommodation in a peaceful neighborhood with excellent connectivity to tech parks. Features clean rooms, good food, and essential amenities for a comfortable stay.',
          rooms: [
            { type: 'Attached', price: 10000, available: true },
            { type: 'Shared', price: 7000, available: true },
            { type: 'Shared', price: 6500, available: true }
          ],
          amenities: ['WiFi', 'Power Backup', 'Laundry', 'Security', 'Meals Included'],
          image: 'https://images.unsplash.com/photo-1560448204-603b3fc33ddc'
        }
      ];
      
      // Navigation functions
      function showHomePage() {
        homePage.style.display = 'block';
        detailPage.classList.remove('active');
        adminPage.classList.remove('active');
        window.scrollTo(0, 0);
      }
      
      function showDetailPage(pgId) {
        const pg = pgs.find(p => p.id === pgId);
        if (!pg) return;
        
        currentPgId = pgId;
        homePage.style.display = 'none';
        adminPage.classList.remove('active');
        detailPage.classList.add('active');
        
        renderPgDetail(pg);
        window.scrollTo(0, 0);
      }
      
      function showAdminPage() {
        homePage.style.display = 'none';
        detailPage.classList.remove('active');
        adminPage.classList.add('active');
        window.scrollTo(0, 0);
      }
      
      // UI rendering functions
      function renderPGs(pgsData) {
        pgs = pgsData;
        
        if (pgs.length === 0) {
          pgsContainer.innerHTML = '<div class="error">No PG listings found.</div>';
          return;
        }
        
        let html = '<div class="pg-grid">';
        pgs.forEach(pg => {
          html += `
            <div class="pg-card">
              <div class="pg-image" style="background-image: url('${pg.image}')"></div>
              <div class="pg-content">
                <h3>${pg.title}</h3>
                <p>${pg.location}</p>
                <div class="rooms">
                  ${pg.rooms.map(room => 
                    `<div class="room">
                      <span>${room.type}</span>
                      <span>₹${room.price}/month</span>
                      <span class="room-status ${room.available ? '' : 'unavailable'}">${room.available ? 'Available' : 'Full'}</span>
                    </div>`
                  ).join('')}
                </div>
                <div class="amenities">
                  ${pg.amenities.slice(0, 3).map(amenity => 
                    `<span class="amenity">${amenity}</span>`
                  ).join('')}
                  ${pg.amenities.length > 3 ? `<span class="amenity">+${pg.amenities.length - 3} more</span>` : ''}
                </div>
                <button class="btn" onclick="viewPG('${pg.id}')">View Details</button>
              </div>
            </div>
          `;
        });
        html += '</div>';
        
        pgsContainer.innerHTML = html;
      }
      
      function renderPgDetail(pg) {
        const availableRooms = pg.rooms.filter(room => room.available);
        const unavailableRooms = pg.rooms.filter(room => !room.available);
        
        let html = `
          <button class="btn back-btn" onclick="goBack()">← Back to Listings</button>
          <h2>${pg.title}</h2>
          <p>${pg.description}</p>
          <div class="pg-image" style="height: 300px; margin: 20px 0; background-image: url('${pg.image}')"></div>
          
          <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px;">
            <div style="flex: 1; min-width: 300px;">
              <h3>Location</h3>
              <p>${pg.location}</p>
              ${pg.locationLink ? `<a href="${pg.locationLink}" target="_blank" class="btn">View on Map</a>` : ''}
            </div>
            
            <div style="flex: 1; min-width: 300px;">
              <h3>Amenities</h3>
              <div class="amenities" style="margin-top: 0;">
                ${pg.amenities.map(amenity => 
                  `<span class="amenity">${amenity}</span>`
                ).join('')}
              </div>
            </div>
          </div>
          
          <h3>Room Options</h3>
          <div style="display: flex; flex-wrap: wrap; gap: 20px;">
            <div style="flex: 1; min-width: 300px;">
              <h4>Available Rooms</h4>
              ${availableRooms.length > 0 ? availableRooms.map(room => 
                `<div class="room">
                  <span>${room.type}</span>
                  <span>₹${room.price}/month</span>
                  <span class="room-status">Available</span>
                </div>`
              ).join('') : '<p>No rooms available currently</p>'}
            </div>
            
            <div style="flex: 1; min-width: 300px;">
              <h4>Currently Full</h4>
              ${unavailableRooms.length > 0 ? unavailableRooms.map(room => 
                `<div class="room">
                  <span>${room.type}</span>
                  <span>₹${room.price}/month</span>
                  <span class="room-status unavailable">Full</span>
                </div>`
              ).join('') : '<p>All rooms are available</p>'}
            </div>
          </div>
          
          <div style="margin-top: 30px; text-align: center;">
            <h3>Interested in this PG?</h3>
            <p>Contact us to book a visit or for more information</p>
            <button class="btn" onclick="contactPG()">Contact Now</button>
          </div>
        `;
        
        detailPage.innerHTML = html;
      }
      
      function renderAdminPgsList() {
        const adminPgsList = document.getElementById('admin-pgs-list');
        
        if (pgs.length === 0) {
          adminPgsList.innerHTML = '<p>No PG listings found. Add your first PG.</p>';
          return;
        }
        
        let html = '<div style="margin-top: 20px;">';
        pgs.forEach(pg => {
          html += `
            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3 style="margin: 0;">${pg.title}</h3>
                <div>
                  <button onclick="editPG('${pg.id}')" class="btn" style="margin-right: 10px; background-color: #ff9800;">Edit</button>
                  <button onclick="deletePG('${pg.id}')" class="btn" style="background-color: #f44336;">Delete</button>
                </div>
              </div>
              <p>${pg.location}</p>
              <p>${pg.rooms.length} room types | ${pg.rooms.filter(r => r.available).length} available</p>
            </div>
          `;
        });
        html += '</div>';
        
        adminPgsList.innerHTML = html;
      }
      
      // Form handling
      function showAddPgForm() {
        formTitle.textContent = 'Add New PG';
        document.getElementById('pg-id').value = '';
        document.getElementById('pg-title').value = '';
        document.getElementById('pg-location').value = '';
        document.getElementById('pg-location-link').value = '';
        document.getElementById('pg-description').value = '';
        document.getElementById('pg-amenities').value = '';
        document.getElementById('pg-image').value = '';
        
        // Clear rooms except the first one
        roomsContainer.innerHTML = `
          <div class="room-input" style="border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; border-radius: 4px;">
            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
              <div style="flex: 1;">
                <label>Type</label>
                <select class="room-type" style="width: 100%; padding: 8px;">
                  <option value="Attached">Attached</option>
                  <option value="Shared">Shared</option>
                </select>
              </div>
              <div style="flex: 1;">
                <label>Price</label>
                <input type="number" class="room-price" min="0" style="width: 100%; padding: 8px;">
              </div>
              <div style="flex: 1;">
                <label>Available</label>
                <select class="room-available" style="width: 100%; padding: 8px;">
                  <option value="true">Yes</option>
                  <option value="false">No</option>
                </select>
              </div>
            </div>
          </div>
        `;
        
        pgForm.style.display = 'block';
      }
      
      function showEditPgForm(pgId) {
        const pg = pgs.find(p => p.id === pgId);
        if (!pg) return;
        
        formTitle.textContent = 'Edit PG';
        document.getElementById('pg-id').value = pg.id;
        document.getElementById('pg-title').value = pg.title;
        document.getElementById('pg-location').value = pg.location;
        document.getElementById('pg-location-link').value = pg.locationLink || '';
        document.getElementById('pg-description').value = pg.description;
        document.getElementById('pg-amenities').value = pg.amenities.join(', ');
        document.getElementById('pg-image').value = pg.image;
        
        // Set rooms
        roomsContainer.innerHTML = '';
        pg.rooms.forEach(room => {
          addRoomToForm(room);
        });
        
        pgForm.style.display = 'block';
      }
      
      function addRoomToForm(roomData = null) {
        const roomDiv = document.createElement('div');
        roomDiv.className = 'room-input';
        roomDiv.style.border = '1px solid #ddd';
        roomDiv.style.padding = '10px';
        roomDiv.style.marginBottom = '10px';
        roomDiv.style.borderRadius = '4px';
        
        roomDiv.innerHTML = `
          <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <div style="flex: 1;">
              <label>Type</label>
              <select class="room-type" style="width: 100%; padding: 8px;">
                <option value="Attached" ${roomData && roomData.type === 'Attached' ? 'selected' : ''}>Attached</option>
                <option value="Shared" ${roomData && roomData.type === 'Shared' ? 'selected' : ''}>Shared</option>
              </select>
            </div>
            <div style="flex: 1;">
              <label>Price</label>
              <input type="number" class="room-price" min="0" style="width: 100%; padding: 8px;" value="${roomData ? roomData.price : ''}">
            </div>
            <div style="flex: 1;">
              <label>Available</label>
              <select class="room-available" style="width: 100%; padding: 8px;">
                <option value="true" ${roomData ? (roomData.available ? 'selected' : '') : 'selected'}>Yes</option>
                <option value="false" ${roomData ? (!roomData.available ? 'selected' : '') : ''}>No</option>
              </select>
            </div>
          </div>
          <button type="button" class="remove-room btn" style="background-color: #f44336;">Remove</button>
        `;
        
        roomsContainer.appendChild(roomDiv);
        
        // Add event listener to remove button
        roomDiv.querySelector('.remove-room').addEventListener('click', function() {
          roomsContainer.removeChild(roomDiv);
        });
      }
      
      function savePgData() {
        const pgId = document.getElementById('pg-id').value;
        const isNewPg = !pgId;
        
        // Get room data
        const roomInputs = document.querySelectorAll('.room-input');
        const rooms = [];
        
        roomInputs.forEach(roomInput => {
          const type = roomInput.querySelector('.room-type').value;
          const price = parseInt(roomInput.querySelector('.room-price').value);
          const available = roomInput.querySelector('.room-available').value === 'true';
          
          if (type && !isNaN(price)) {
            rooms.push({ type, price, available });
          }
        });
        
        const pgData = {
          id: isNewPg ? String(Date.now()) : pgId,
          title: document.getElementById('pg-title').value,
          location: document.getElementById('pg-location').value,
          locationLink: document.getElementById('pg-location-link').value,
          description: document.getElementById('pg-description').value,
          amenities: document.getElementById('pg-amenities').value.split(',').map(a => a.trim()).filter(a => a),
          image: document.getElementById('pg-image').value || 'https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af',
          rooms: rooms
        };
        
        if (isNewPg) {
          pgs.push(pgData);
        } else {
          const index = pgs.findIndex(p => p.id === pgId);
          if (index !== -1) {
            pgs[index] = pgData;
          }
        }
        
        // In a real app, we would save to the backend
        // savePgToBackend(pgData);
        
        // Update UI
        renderAdminPgsList();
        pgForm.style.display = 'none';
      }
      
      // Event listeners
      adminLink.addEventListener('click', function(e) {
        e.preventDefault();
        showAdminPage();
      });
      
      loginBtn.addEventListener('click', function() {
        if (adminPassword.value === adminPwd) {
          loginForm.style.display = 'none';
          adminContent.style.display = 'block';
          loginError.style.display = 'none';
          renderAdminPgsList();
        } else {
          loginError.style.display = 'block';
        }
      });
      
      addPgBtn.addEventListener('click', showAddPgForm);
      
      cancelFormBtn.addEventListener('click', function() {
        pgForm.style.display = 'none';
      });
      
      pgEditForm.addEventListener('submit', function(e) {
        e.preventDefault();
        savePgData();
      });
      
      addRoomBtn.addEventListener('click', function() {
        addRoomToForm();
      });
      
      // Global functions (needed for onclick attributes)
      window.viewPG = function(id) {
        showDetailPage(id);
      };
      
      window.goBack = function() {
        showHomePage();
      };
      
      window.editPG = function(id) {
        showEditPgForm(id);
      };
      
      window.deletePG = function(id) {
        if (confirm('Are you sure you want to delete this PG?')) {
          pgs = pgs.filter(pg => pg.id !== id);
          renderAdminPgsList();
          renderPGs(pgs);
        }
      };
      
      window.contactPG = function() {
        alert('This feature will be implemented in the future. For now, please call +91 9876543210.');
      };
      
      // Load initial data
      function fetchPGs() {
        // In a real app, fetch from backend
        // fetch('http://localhost:8000/api/pgs')
        //   .then(response => response.json())
        //   .then(data => renderPGs(data))
        //   .catch(error => {
        //     console.error('Error loading PGs:', error);
        //     pgsContainer.innerHTML = '<div class="error">Failed to load PG listings. Please try again later.</div>';
        //   });
        
        setTimeout(() => {
          renderPGs(samplePGs);
        }, 500);
      }
      
      // Initialize app
      fetchPGs();
      showHomePage();
    });
  </script>
</body>
</html>